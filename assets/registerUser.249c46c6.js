import{e as b,l as E,r as d,o as F,m as A,n as s,w as l,p as f,ab as k}from"./index.eec0c036.js";import{u as h,a as _,_ as x,N as R}from"./request.69d1c4cf.js";import{_ as N,a as U}from"./FormItem.dc9ef91e.js";import"./use-rtl.75d4725a.js";const z={class:"login-page glass-bg"},D=f(" \u6CE8\u518C "),S=b({name:"registerUser",setup(T){const v=E(),g=/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/,i=h(),p=d(null),B={email:[{key:"email",required:!0,validator(u,e){return g.test(e)},message:"\u8BF7\u8F93\u5165\u6CE8\u518C\u90AE\u7BB1",trigger:["blur"]}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]},a=d({email:"",code:"",password:""}),n=d(0);async function C(){var u;(u=p.value)==null||u.validate(async e=>{e||(await _.toRegister(a.value)).code===200&&(i.success("\u6CE8\u518C\u6210\u529F"),setTimeout(()=>{v.push("/login")},500))})}function c(u=60){n.value=u,setTimeout(()=>{n.value>0&&c(u-1)},1e3)}function w(){var u;(u=p.value)==null||u.validate(async e=>{if(!e){const o={email:a.value.email},t=await _.registerEmailCode(o);t.code===200?(i.success("\u8BF7\u53BB\u524D\u5F80\u90AE\u7BB1\u67E5\u770B\u9A8C\u8BC1\u7801"),c()):i.error(t.message)}},e=>e.key==="email")}return(u,e)=>{const o=x,t=U,m=R,y=N;return F(),A("div",z,[s(y,{ref_key:"formRef",ref:p,class:"glass-card",size:"large",rules:B,model:a.value,"label-placement":"left"},{default:l(()=>[s(t,{path:"email",label:""},{default:l(()=>[s(o,{value:a.value.email,"onUpdate:value":e[0]||(e[0]=r=>a.value.email=r),"input-props":{type:"email"},placeholder:"\u8BF7\u8F93\u5165\u6CE8\u518C\u7684\u90AE\u7BB1"},null,8,["value"])]),_:1}),s(t,{path:"code",label:""},{default:l(()=>[s(o,{value:a.value.code,"onUpdate:value":e[1]||(e[1]=r=>a.value.code=r),placeholder:"\u90AE\u7BB1\u9A8C\u8BC1\u7801","input-props":{autoComplete:"off"}},null,8,["value"]),s(m,{style:{width:"120px","margin-left":"8px"},disabled:n.value!==0,onClick:w},{default:l(()=>[f(k(n.value===0?"\u83B7\u53D6\u9A8C\u8BC1\u7801":n.value+"s"),1)]),_:1},8,["disabled"])]),_:1}),s(t,{path:"password",label:""},{default:l(()=>[s(o,{value:a.value.password,"onUpdate:value":e[2]||(e[2]=r=>a.value.password=r),type:"password","show-password-on":"click","input-props":{autoComplete:"new-password"},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["value"])]),_:1}),s(m,{round:"",onClick:C},{default:l(()=>[D]),_:1})]),_:1},8,["model"])])}}});export{S as default};
